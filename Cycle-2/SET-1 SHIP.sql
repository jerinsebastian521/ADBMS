CREATE TABLE SAILORS
(
SID INT,
SNAME VARCHAR(20),
RATING INT,
AGE INT
);

INSERT INTO SAILORS(SID,SNAME,RATING,AGE)
VALUES(22,'Dustin', 7,45),
(29, 'Brutas', 1,33),
(31,'Lubber',8,55),
(32,'Andy',8,25),
(58,'Rusty',10,35),
(64,'Horatio',7,35),
(71,'Zorba',10,16),
(74,'Horatio',9,35),
(85,'Art',3,26),
(95,'Bob',3,64);


CREATE TABLE BOATS
(
BID INT,
BNAME VARCHAR(20),
COLOR VARCHAR(20)
);


INSERT INTO BOATS(BID,BNAME,COLOR)
VALUES(101,'Interlake',	'Blue'),
(102,'Interlake','Red'),
(103,'Clipper','Green'),
(104,'Marine','Red');

CREATE TABLE RESERVES
(
SID INT,
BID INT,
DAY DATE
);

INSERT INTO RESERVES(SID,BID,DAY)
VALUES(22,101,'1998-10-10'),
(22,102,'1998-10-10'),
(22,103,'1998-08-10'),
(22,104,'1998-07-10'),
(31,102,'1998-10-11'),
(31,103,'1998-06-11'),
(64,101,'1998-05-09'),
(64,102,'1998-08-09'),
(74,103,'1998-08-09');

SELECT SNAME,AGE FROM SAILORS;

SELECT * FROM SAILORS,RESERVES WHERE SAILORS.SID=RESERVES.SID AND BID=101;

SELECT SNAME FROM SAILORS WHERE RATING>7;

SELECT SNAME FROM SAILORS,RESERVES,BOATS WHERE   BOATS.BID=103 AND BOATS.BID=RESERVES.BID AND SAILORS.SID=RESERVES.SID;

SELECT DISTINCT SNAME FROM SAILORS,BOATS,RESERVES  WHERE COLOR='RED' AND BOATS.BID=RESERVES.BID  AND SAILORS.SID=RESERVES.SID;

SELECT DISTINCT SNAME
FROM SAILORS,BOATS,RESERVES  WHERE (COLOR='RED' OR COLOR ='GREEN' ) 
AND BOATS.BID=RESERVES.BID  
AND SAILORS.SID=RESERVES.SID;

SELECT DISTINCT COLOR FROM SAILORS,BOATS,RESERVES WHERE SNAME='LUBBER'
AND BOATS.BID=RESERVES.BID  
AND SAILORS.SID=RESERVES.SID;

SELECT DISTINCT SNAME FROM SAILORS,BOATS,RESERVES WHERE (COLOR='RED' OR COLOR ='GREEN' ) 
AND BOATS.BID=RESERVES.BID  
AND SAILORS.SID=RESERVES.SID;

SELECT DISTINCT SNAME FROM SAILORS,RESERVES WHERE SAILORS.SID=RESERVES.SID;

SELECT RESERVES.SID,SNAME FROM SAILORS,RESERVES WHERE SAILORS.SID=RESERVES.SID GROUP BY DAY,RESERVES.SID,SNAME HAVING COUNT(DAY)>1; 

SELECT SNAME,AGE FROM SAILORS WHERE AGE=(SELECT MIN(AGE) FROM SAILORS);

SELECT SNAME,RATING FROM SAILORS WHERE RATING>(SELECT MAX(RATING) FROM SAILORS WHERE SNAME='HORATIO'); 

SELECT SNAME,SID FROM
 (SELECT SNAME,RESERVES.SID,
 COUNT(BID) AS id FROM RESERVES,SAILORS
 WHERE RESERVES.SID = SAILORS.SID GROUP BY RESERVES.SID, SNAME) a WHERE id = ( SELECT COUNT(BID) FROM BOATS ); 
 
 SELECT COUNT(C.SNAME) FROM (SELECT DISTINCT SNAME FROM SAILORS)C;
 
SELECT AVG(AGE) FROM SAILORS;

SELECT rating,AVG(age) FROM SAILORS GROUP BY  RATING;

SELECT a.RATING,b.MEAN FROM (SELECT COUNT(SNAME) AS NUM,RATING FROM SAILORS GROUP BY RATING HAVING COUNT(SNAME)>1) a,
(SELECT RATING,AVG(AGE) AS MEAN FROM SAILORS GROUP BY RATING) b WHERE a.RATING = b.RATING;