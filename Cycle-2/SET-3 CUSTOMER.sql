USE CUSTOMER;
CREATE TABLE CUSTOMER
(
CUST_ID INT PRIMARY KEY,
CUST_NAME VARCHAR(20) NOT NULL
);
CREATE TABLE ITEM
(
ITEM_ID INT PRIMARY KEY,
ITEM_NAME VARCHAR(20),
PRICE INT
);
CREATE TABLE SALE
(
BILL_NO INT PRIMARY KEY,
BILL_DATE DATE NOT NULL,
CUST_ID INT NOT NULL,
ITEM_ID INT NOT NULL,
QUANTITY_SOLD INT NOT NULL, 
FOREIGN KEY(ITEM_ID) REFERENCES ITEM(ITEM_ID),
FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(CUST_ID)
);
INSERT INTO CUSTOMER(CUST_ID,CUST_NAME)
VALUES(1, 'Rekha'),
(2, 'Rani'),
(3, 'Rocky'),
(4, 'Xin'),
(5, 'Kim');

INSERT INTO ITEM(ITEM_ID,ITEM_NAME,PRICE)
VALUES(1, 'Rusk', 120),
(2, 'Banana', 50),
(3, 'Sanitizer', 60),
(4, 'Cake', 420),
(5, 'Laddu', 25);

INSERT INTO SALE(BILL_NO,BILL_DATE,CUST_ID,ITEM_ID,QUANTITY_SOLD)
VALUES(10, '2020-10-01', 1, 1,3),
(11, '2020-10-01', 1, 3,2),
(12,'2020-10-01', 1, 5,7),
(13,'2018-10-01', 4, 4,1),
(14,'2018-10-11', 4, 2,2),
(15,'2018-09-29', 5, 1,5),
(16,'2019-12-25', 3, 1,5),
(17,'1995-06-21', 5, 4,4),
(18, '2002-04-01', 4, 5,5),
(19,'2020-02-12', 1, 2,1);

SELECT * FROM SALE;

SELECT * FROM CUSTOMER,SALE,ITEM
WHERE PRICE>200 AND SALE.ITEM_ID=ITEM.ITEM_ID
AND SALE.CUST_ID=CUSTOMER.CUST_ID;

SELECT CUST_NAME,PROD_NUMS,BILL_DATE FROM CUSTOMER,
(SELECT CUST_ID,COUNT(ITEM_ID) AS PROD_NUMS,BILL_DATE
FROM SALE GROUP BY (BILL_DATE) ) ci WHERE ci.CUST_ID = CUSTOMER.CUST_ID;

SELECT CUST_NAME,COUNT(ITEM_ID),BILL_DATE
FROM CUSTOMER c,SALE s
WHERE c.CUST_ID = s.CUST_ID GROUP BY CUST_NAME,
BILL_DATE HAVING EXTRACT(YEAR FROM BILL_DATE) = 2018;

SELECT ITEM_NAME FROM ITEM,SALE WHERE SALE.ITEM_ID = ITEM.ITEM_ID AND SALE.CUST_ID = 5;

SELECT ITEM_NAME,PRICE,QUANTITY_SOLD FROM ITEM ,SALE
WHERE SALE.ITEM_ID = ITEM.ITEM_ID AND BILL_DATE = CURDATE();

SELECT ITEM_NAME, QUANTITY_SOLD,PRICE,(QUANTITY_SOLD * PRICE) AS TOTAL_AMOUNT FROM CUSTOMER,ITEM ,SALE
WHERE CUST_NAME = 'Rekha' AND SALE.ITEM_ID = ITEM.ITEM_ID AND SALE.CUST_ID=CUSTOMER.CUST_ID;