USE LOAN;

CREATE TABLE LOAN_ACCOUNTS
(
ACCNO CHAR(4),
CUST_NAME VARCHAR(15),
LOAN_AMOUNT DECIMAL(7,2),
INSTALLMENTS INT,
INT_RATE DECIMAL(2,2),
START_DATE DATE,
INTREST DECIMAL(7,2));


ALTER TABLE LOAN_ACCOUNTS
ADD COLUMN CATEGORY VARCHAR(20);

INSERT  INTO LOAN_ACCOUNTS(ACCNO,CUST_NAME,LOAN_AMOUNT,INSTALLMENTS,INT_RATE,START_DATE)
VALUES(1001,'R.K Gupta',300000.00,36,12.00,	'2009-07-19'),
(1002,'S.P Sharma',500000.00,48,10.00,'2008-03-22'),
(1003,'K.P Jain',300000.00,36,NULL,'2007-08-03'),
(1004,'M.P Yadav',800000.00,60,	10.00,'2008-06-12'),
(1005,'	S.P Sinha',200000.00,36,12.50,'2010-03-01'),
(1006,	'P. Sharma',700000.00,60,12.50,'2008-05-06'),
(1007,'	K.S Dhall',500000.00,48,NULL,'2008-05-03');

UPDATE LOAN_ACCOUNTS
SET INT_RATE= 11.50 WHERE INT_RATE IS NULL;

UPDATE LOAN_ACCOUNTS
SET INT_RATE= INT_RATE+0.5 WHERE LOAN_AMOUNT>=400000.00 ;


UPDATE LOAN_ACCOUNTS
SET INTREST=(LOAN_AMOUNT * INT_RATE * INSTALLMENTS)/(12*100);

DELETE FROM LOAN_ACCOUNTS WHERE START_DATE <='2007-12-30';

DELETE  FROM LOAN_ACCOUNTS WHERE CUST_NAME LIKE 'K%' ;

SELECT * FROM LOAN_ACCOUNTS WHERE INSTALLMENTS<40;

SELECT ACCNO,LOAN_AMOUNT  FROM LOAN_ACCOUNTS WHERE START_DATE<'2009-04-01';

SELECT INT_RATE  FROM LOAN_ACCOUNTS WHERE START_DATE>='2009-04-01';

SELECT ACCNO,CUST_NAME,LOAN_AMOUNT  FROM LOAN_ACCOUNTS WHERE CUST_NAME LIKE '%sharma';

SELECT LOAN_AMOUNT  FROM LOAN_ACCOUNTS WHERE CUST_NAME LIKE '%a';

SELECT ACCNO,CUST_NAME,LOAN_AMOUNT  FROM LOAN_ACCOUNTS WHERE CUST_NAME LIKE '%a%';

SELECT ACCNO,CUST_NAME,LOAN_AMOUNT  FROM LOAN_ACCOUNTS WHERE CUST_NAME NOT LIKE '%P%';

DESC LOAN_ACCOUNTS;

SELECT   *  FROM LOAN_ACCOUNTS ORDER BY START_DATE DESC;

SELECT   *  FROM LOAN_ACCOUNTS ORDER BY LOAN_AMOUNT ASC , START_DATE DESC;

SELECT ACCNO,CUST_NAME,LOAN_AMOUNT  FROM LOAN_ACCOUNTS WHERE CUST_NAME LIKE 'k%';

SELECT * FROM LOAN_ACCOUNTS WHERE INT_RATE IS NULL;

SELECT * FROM LOAN_ACCOUNTS WHERE INT_RATE IS NOT NULL;

SELECT DISTINCT LOAN_AMOUNT  FROM LOAN_ACCOUNTS ;

SELECT   *  FROM LOAN_ACCOUNTS WHERE START_DATE >'2008-12-31' AND INSTALLMENTS>36;

SELECT CUST_NAME,LOAN_AMOUNT  FROM LOAN_ACCOUNTS WHERE LOAN_AMOUNT<500000 OR INT_RATE>12;

SELECT   * FROM LOAN_ACCOUNTS WHERE START_DATE BETWEEN '2009-01-01' AND '2009-12-31';

SELECT   *  FROM LOAN_ACCOUNTS WHERE LOAN_AMOUNT BETWEEN 400000 AND 500000 ;

SELECT CUST_NAME,LOAN_AMOUNT  FROM LOAN_ACCOUNTS WHERE INSTALLMENTS IN(26 ,36 , 48);


SELECT CUST_NAME,LOAN_AMOUNT,  IFNULL ( INT_RATE,0) AS INT_RATE FROM  LOAN_ACCOUNTS;

SELECT CUST_NAME,LOAN_AMOUNT,  IFNULL ( INT_RATE,'NO INTREST') AS INT_RATE FROM  LOAN_ACCOUNTS;