CREATE TABLE BRANCH
(
BID INT,
BRANCH_NAME VARCHAR(20) NOT NULL,
BRANCH_CITY VARCHAR(20),
ASSETS INT,
PRIMARY KEY(BID)
);

CREATE TABLE ACCOUNTS
(
ACCNO INT,
BID INT,
BALANCE INT,
PRIMARY KEY(ACCNO),
FOREIGN KEY(BID) REFERENCES BRANCH(BID)
);

CREATE TABLE DEPOSITOR
(
CID INT,
ACCNO INT,
FOREIGN KEY(ACCNO) REFERENCES ACCOUNTS(ACCNO),
FOREIGN KEY(CID) REFERENCES CUSTOMER(CID)
);

CREATE TABLE CUSTOMER
(
CID INT,
CNAME VARCHAR(20),
CSTREET VARCHAR(20),
CCITY VARCHAR(20),
PRIMARY KEY(CID)
);


INSERT INTO BRANCH(BID,BRANCH_NAME,BRANCH_CITY,ASSETS)VALUES
(1,'HB','C1',5000000),
(2,'B1','C2',400000),
(3,'B2','C3',300000);

INSERT INTO ACCOUNTS(ACCNO,BID,BALANCE)VALUES
(100,2,10000),
(200,1,5000),
(300,1,15000),
(400,3,20000),
(500,2,6000);

INSERT INTO CUSTOMER(CID,CNAME,CSTREET,CCITY)VALUES
(001,'SHYAM','ST1','PUNE'),
(002,'AJU','STR3','KOCHI'),
(003,'ANU','STR6','CHENNAI'),
(004,'ANTO','STR5','DELHI');

INSERT INTO DEPOSITOR(CID,ACCNO)VALUES
(001,500),
(002,400),
(004,200),
(004,300),
(003,100);

SELECT CUSTOMER.CID,CNAME,BRANCH_NAME FROM BRANCH,CUSTOMER,DEPOSITOR,ACCOUNTS
WHERE CUSTOMER.CID=DEPOSITOR.CID AND DEPOSITOR.ACCNO=ACCOUNTS.ACCNO AND ACCOUNTS.BID=1 
GROUP BY ACCOUNTS.BID HAVING COUNT(ACCOUNTS.BID)>=2;

SELECT CUSTOMER.CID,CNAME,ACCOUNTS.ACCNO,BRANCH_CITY FROM ACCOUNTS,BRANCH,DEPOSITOR,CUSTOMER 
WHERE BRANCH.BID=ACCOUNTS.BID AND ACCOUNTS.ACCNO=DEPOSITOR.ACCNO AND DEPOSITOR.CID=CUSTOMER.CID
AND BRANCH.BRANCH_CITY='C2'
GROUP BY DEPOSITOR.CID HAVING COUNT(DISTINCT BRANCH.BID)=(SELECT COUNT(BID) FROM BRANCH WHERE BRANCH_CITY='C2');


SELECT * FROM BRANCH WHERE ASSETS= (SELECT MAX(ASSETS) FROM BRANCH);

SELECT CUSTOMER.CID,CNAME,ACCOUNTS.ACCNO,BALANCE FROM CUSTOMER,DEPOSITOR,ACCOUNTS 
WHERE CUSTOMER.CID=DEPOSITOR.CID AND DEPOSITOR.ACCNO=ACCOUNTS.ACCNO AND BALANCE=(SELECT MAX(BALANCE) FROM ACCOUNTS);